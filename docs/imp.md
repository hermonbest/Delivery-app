Delivery App Implementation Plan
IMPORTANT

Updated Compliance: Adjusted to React Native (Expo) and Firebase as per PRD.

Goal Description
Build a React Native (Expo) application for the "Unified Delivery Ecosystem". Phase 2: Integrate Firebase (Auth & Firestore) to replace the Mock Service. The app will support 3 roles (Customer, Admin, Driver) and the full "Handshake" delivery flow.

User Review Required
IMPORTANT

Firebase Credentials Expected: I will need your firebaseConfig object (apiKey, authDomain, projectId, etc.) to proceed.

NOTE

Development Strategy:

Phase 1 (Rapid Logic): Use a Mock Service first. This allows us to test the complex "Order -> Assign -> Handshake -> Deliver" logic instantly in the browser/simulator without debugging Firebase connection/auth issues initially. Platform: We will use Expo. It allows running on the Web for fast "feature-by-feature" testing during development, while still producing a native Android/iOS app. Styling: Switched to Vanilla React Native StyleSheet. NativeWind v4 is currently incompatible with the Windows drive-path logic on Node 18. Standard styling will be used for maximum stability.
Phase 3: Advanced Features & Polish (Planned)
Data Layer: Upgrade to Real Firebase Auth (Email/Google)
UI/UX: "Add to Cart" functionality (Redux/Zustand persist)
Maps:
Customer: Live driver pin on map (react-native-maps)
Driver: Navigation/Route display
Polish:
Toast notifications
Order History
Proposed Changes
Project Setup
[NEW]
package.json
Initialize Expo project (npx create-expo-app)
Install react-native-web for browser testing
Removed: NativeWind and Tailwind. Using standard StyleSheet.
Core Logic (Mock -> Firebase)
[NEW]
store.js
Abstracted Service Layout: Build an interface DeliveryService that can switch between MockDeliveryService and FirebaseDeliveryService.
State: Use a lightweight global store (e.g., Zustand or React Context) to hold user, activeOrders.
UI Components (Screens)
Navigation
[NEW]
App.js
Root entry point. Sets up Navigation (Stack/Tabs).
Authentication
[NEW]
LoginScreen.js
Role selector for testing (Customer, Admin, Driver).
Customer Role
[NEW]
CustomerHome.js
List of items (Mock data initially).
"Order Now" button (Triggers
createOrder
).
Status Banner: Real-time view of order state.
Admin Role
[NEW]
AdminDashboard.js
List of "Pending" orders.
Dispatch Modal: Select Driver for an order.
Driver Role
[NEW]
DriverDashboard.js
Toggle "On/Off Duty".
Job Card: Shows "Accept" button for assigned orders.
Active Order View: "Mark Delivered" button.
Verification Plan
Automated Tests
Unit Tests: Test
store.js
logic (e.g., does
acceptOrder
change status to Processing?).
Manual Verification (Feature by Feature)
Run Web: npx expo start --web
Test Loop:
Login: Sign in as Customer -> Create Order.
Verify: Check logs/UI for "Order Pending".
Switch: Sign in as Admin -> Assign Driver.
Verify: Check logs/UI for "Order Assigned".
Switch: Sign in as Driver -> Accept -> Deliver.
Verify: Check logs/UI for "Order Delivered".
Phase 3: Detailed Specifications (Next Steps)

1. Map Integration (react-native-maps)
   Goal: Visualize the driver's location and route.
   Customer View:
   Replace the "Driver is X mins away" card with a Mini Map.
   Show Pins: Customer Address (Destination) and Driver Location (Moving Pin).
   Polyline: Draw path between driver and customer (using Google Directions API or simple line).
   Driver View:
   Show map with pickup/dropoff points.
   "Navigate" button to open Google Maps/Waze/Apple Maps.
2. Authentication Upgrade
   Goal: Secure, persistent user accounts.
   Changes:
   Replace signInAnonymously with signInWithEmailAndPassword and createUserWithEmailAndPassword.
   Add Registration Screen: Name, Email, Password, Role.
   Store user profiles in users/{uid} collection.
   Persist "Cart" data to user profile.
3. User Experience (Cart Logic)
   Goal: Allow multiple items in one order.
   Changes:
   Update
   store.js
   to have a cart: [] array.
   "Add to Cart" button instead of immediate "Order Now".
   Floating Cart Button: Shows total items/price.
   Cart Screen: Review items, update quantities, checkout.
4. Driver Route View
   Goal: Help drivers see where they are going.
   Changes:
   Display map on
   DriverDashboard
   when job is active.
   Show route line from current location to delivery address.
   Troubleshooting
   Windows ERR_UNSUPPORTED_ESM_URL_SCHEME
   Issue: Node.js ESM loader on Windows rejects absolute paths (e.g. d:/...) generated by NativeWind config.
   Fix: Adjust metro.config.js to handle input path safely or avoid absolute path conflict.

Phase 3: Advanced Features (Next)

Maps Integration
Install react-native-maps
Customer: Show Driver Pin on Map
Driver: Show Route/Directions
Authentication Upgrade
Replace Anonymous with Email/Password
Create Registration Screen
UX Improvements
Feature: Shopping Cart (Multiple Items)
Feature: Order History
